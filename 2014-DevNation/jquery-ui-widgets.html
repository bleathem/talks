<!DOCTYPE html><html lang="en" class="aspect-16-9"><head><meta charset="UTF-8" /><meta name="generator" content="Asciidoctor 1.5.0.preview, dzslides backend" /><title>Hands on with the jQuery UI widget factory</title><meta name="author" content="Brian Leathem" /><link rel="stylesheet" href="/assets/jquery-ui-theme/jquery-ui.css" /><link rel="stylesheet" href="/assets/stopwatch.css" /><link rel="stylesheet" href="/assets/bootstrap-button.css" /><link rel="stylesheet" href="/assets/font-awesome.min.css" /><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Bevan" /><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700,800" /><link rel="stylesheet" href="./dzslides/themes/highlight/github.css" /><link rel="stylesheet" href="./dzslides/themes/style/../../../themes/devnation.css" /><link rel="stylesheet" href="./dzslides/core/dzslides.css" /><link rel="stylesheet" href="./dzslides/themes/transition/fade.css" /><script src="/assets/jquery.min.js"></script><script>jQuery.noConflict()</script><script src="assets/jquery-ui.min.js"></script><script src="/assets/stopwatch.js"></script></head><body><section class="front"></section><section class="title"><h1>Hands on with the jQuery UI widget factory</h1><footer><span class="author">Brian Leathem</span> <span class="email"><a href="https://github.com/brianleathem">@brianleathem</a></span></footer></section><section><h2>The plan</h2><div class="content"><div class="openblock side-by-side"><div class="list"><ul><li>jQuery Plugin review</li><li>Widget factory advantages</li><li>Use cases and examples</li></ul></div>
<img src="images/storm_troopers.jpg" alt="http://www.flickr.com/photos/jdhancock/5845280258/" /></div>
<details><details open=""><summary>Notes</summary></details></details></div></section>
<section><h2>Who am I?</h2><div class="content"><div class="openblock side-by-side"><img src="images/silhouette.png" alt="http://leslycorazon.wikispaces.com/file/detail/head-silhouette-with-question-mark.png/319199232" />
<div class="list"><ul><li>Brian Leathem</li><li>Software Engineer @ Red Hat</li><li>RichFaces project lead (JSF)</li><li>RichWidgets&#8201;&#8212;&#8201;<a href="http://richwidgets.io">http://richwidgets.io</a></li></ul></div></div></div></section>
<section class="topic"><h2>jQuery Plugins</h2><div class="content"></div></section>
<section><h2>Who are you?</h2><div class="content"><img src="images/crowd.png" alt="http://openclipart.org/detail/crowd-by-kattekrab" /></div></section>
<section><h2>jQuery Plugins</h2><div class="content"><div class="openblock side-by-side"><div class="list"><ul><li>An easy way to share code</li><li>Great for "simple" use cases</li></ul></div>
<div class="listingblock"><pre class="highlight"><code class="javascript">(function( $ ) {
 $.fn.myplugin = function() {
  return this.each(function() {
   $(this)
    .addClass("some-class")
    .css("color", "red");
   });
 };
})( jQuery );</code></pre></div></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Show of hands from those of you who feel you are proficient with javascript?</li><li>Show of hands from those of you who have authored a jQuery plugin?</li><li>De-facto standard</li></ul></div></details></details></div></section>
<section class="center"><h2>Use cases</h2><div class="content"><p>Well suited to use cases where plugin execution<br />
<em>results in some intended side-effect:</em></p>
<div class="list"><ul><li>Text manipulation</li><li>Animation</li><li>Layout</li></ul></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Provide a means to manipulate a set of DOM objects</li><li>jQuery plugins execute <strong>once</strong></li></ul></div></details></details></div></section>
<section><h2>Stateful plugins</h2><div class="content"><div class="openblock side-by-side"><div class="list"><ul><li>Track &amp; query state</li><li>Mutate options</li><li>Plugin interactions</li><li>Reverse DOM changes</li><li>Notify event listeners</li></ul></div>
<p><span class="emphasis">Widgets</span></p></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>There are a number of concerns that are not addressed out-of-the box with the jQuery plugin syntax</li><li>These include&#8230;</li><li>Some examples of these include</li></ul></div></details></details></div></section>
<section><h2>A Stateful Widget</h2><div class="content"><div class="openblock side-by-side"><div class="list"><ul><li>The active tab is the widget state</li><li>Use the javascript API to cycle the active tab<div>
<button class='btn' onclick="var active = jQuery( '#tabs' ).tabs('option', 'active'); jQuery( '#tabs' ).tabs('option', 'active', (active + 1) % 3)" style="font-size: 30px; margin-top: 20px">Cycle Tabs</button>
<div></li></ul></div>
<div>
<div id="tabs" class="live-demo" style="width: 400px; height: 234px;">
  <ul>
    <li><a href="#fragment-1"><span>One</span></a></li>
    <li><a href="#fragment-2"><span>Two</span></a></li>
    <li><a href="#fragment-3"><span>Three</span></a></li>
  </ul>
  <div id="fragment-1">
    <p>Instantiate the widget as a jQuery plugin:</p>
    <pre><code>$( "#tabs" ).tabs(); </code></pre>
  </div>
  <div id="fragment-2">
    <p class="javascript">Query the active tab using the <em>active</em> option:</p>
    <pre><code>jQuery('#tabs')
  .tabs('option', 'active');</code></pre>
  </div>
  <div id="fragment-3">
    <p class="javascript">Set the active tab with the same <em>active</em> option:</p>
    <pre><code>jQuery('#tabs')
  .tabs('option', 'active', value);</code></pre>
  </div>
</div>
<div></div>
<script>jQuery( '#tabs' ).tabs();</script></div></section>
<section><h2>Widgets with OOP</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">( function( $ ) {
  function MyWidget( element ) {
    this.init( element );
  }
  MyWidget.prototype.init = ...
  MyWidget.prototype.destroy = ...
  MyWidget.prototype.addListener = ...
  MyWidget.prototype.removeListener = ...
  MyWidget.prototype.setOption = ...

  ...</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>This isn&#8217;t to say there aren&#8217;t jQuery plugins out there that track state</li></ul></div></details></details></div></section>
<section><h2>Widgets with OOP</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">( function( $ ) {
  ...

  $.fn.mywidget = function() {
    return this.each( function() {
      $.data( this, "mywidget", new MyWidget( this ) );
    });
  };
})( jQuery );</code></pre></div></div></section>
<section><h2>Widgets with OOP</h2><div class="content"><p>Interact with the widget via an API:</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">$(document).ready( function() {
  var widget = $( "#foo" ).mywidget().data( "mywidget" );
  widget.doSomething();
});</code></pre></div></div></section>
<section><h2>OOP | Boilerplate</h2><div class="content"><p>Encapsulate the boilerplate code in a common prototype function:</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">( function( $ ) {
  MyWidget.prototype = ...
  $.extend(MyWidget.prototype, myPrototype);
})(jQuery);</code></pre></div></div></section>
<section class="center"><h2>OOP | Advantages</h2><div class="content"><div class="list"><ul><li>Object instance</li><li>API for interactions</li><li>D.R.Y. w/ a Shared prototype</li></ul></div></div></section>
<section class="center"><h2>OOP | Dis-advantages</h2><div class="content"><div class="list"><ul><li>Custom prototype maintenance</li><li>Non-standard API<div class="list"><ul><li>events</li><li>mutable options</li></ul></div></li></ul></div></div></section>
<section class="topic"><h2>jQuery UI Widget Factory</h2><div class="content"></div></section>
<section><h2>jQuery UI widget factory</h2><div class="content"><div class="openblock side-by-side"><div class="list"><ul class="checks"><li>Track &amp; query state</li><li>Mutate options</li><li>Widget interactions</li><li>Reverse DOM changes</li><li>Notify event listeners</li></ul></div>
<div class="center emphasis" style="width: 50%">Consistent<br />API</div></div>
<details><details open=""><summary>Notes</summary><p>The jQuery UI widget factory provides this shared prototype.</p></details></details></div></section>
<section><h2>Stopwatch example</h2><div class="content"><div class="openblock side-by-side"><div class="listingblock center""><pre class="highlight"><code class="javascript">jQuery('#timer').stopwatch();</code></pre></div>
<img src="images/stopwatch.jpg" alt="http://www.flickr.com/photos/26782864@N00/3297205226/" /></div></div></section>
<section><h2>window.setInterval</h2><div class="content"><blockquote><p>Calls a function or executes a code snippet repeatedly, with a fixed time delay between each call to that function.</p></blockquote>
<div class="listingblock"><pre class="highlight"><code class="javascript">createInterval: function() {
  this.intervalId = setInterval(
       $.proxy(this._decrementCount, this),
       this.increment
  );
},</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>The least interesting part of the example</li></ul></div></details></details></div></section>
<section><h2>Stopwatch example</h2><div class="content"><div id="timer" class="stopwatch">
    <div class="digits">10</div>
</div>
<p class='center'>
  <button class="btn" onclick="jQuery('#timer').stopwatch()">Execute</button>
</p>

<script>
//jQuery('#timer').stopwatch();
</script></div></section>
<section><h2>Stopwatch example</h2><div class="content"><div id="timer2" class="stopwatch">
    <div class="digits">10</div>
</div>

<div class='center'>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('start')">Start</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('pause')">Pause</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('resume')">Resume</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('stop')">Stop</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('reset')">Reset</button>
</div>
<div class='center'>
  <button class="btn" onclick="jQuery('#timer2').stopwatch(window.richwidgets.timerOptions)">Execute</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('destroy')">Destroy</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('enable')">Enable</button>
  <button class="btn" onclick="jQuery('#timer2').stopwatch('disable')">Disable</button>
</div>
<script>
(function($) {
  var ready = '#428bca';
  var active = '#5cb85c';
  var waiting = '#f0ad4e';
  var stopped = '#d9534f';
  var originalBg = $('#timer').css('background-color');
  var originalColor = $('#timer').css('color');

  var options = {
    autostart: false,
    create: function(event, ui) {
      ui.element.css('background-color', ready);
      ui.element.css('color', 'white');
    },
    reset: function(event, ui) {
      ui.element.css('background-color', ready);
    },
    start: function(event, ui) {
      ui.element.css('background-color', active);
    },
    resume: function(event, ui) {
      ui.element.css('background-color', active);
    },
    pause: function(event, ui) {
      ui.element.css('background-color', waiting);
    },
    stop: function(event, ui) {
      ui.element.css('background-color', stopped);
    },
    destroy: function(event, ui) {
      ui.element.css('background-color', originalBg);
      ui.element.css('color', originalColor);
    }
  };

  window.richwidgets = window.richwidgets || {};
  window.richwidgets.timerOptions = options;

  $('#timer2').stopwatch(options);

})(jQuery);
</script></div></section>
<section><h2>Widget Factory Deep Dive</h2><div class="content"><div class="openblock side-by-side"><div class="listingblock"><pre class="highlight"><code class="javascript">(function($) {
  $.widget("rich.stopwatch", {
    /** prototype object **/
  });
})(jQuery);</code></pre></div>
<img src="images/factory.jpg" alt="http://commons.wikimedia.org/wiki/File:Thunderbird_assembly_line.jpg" /></div></div></section>
<section><h2>Anatomy of a widget</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">( function( $ ) {
  $.widget( "rich.stopwatch", {
    options: { ... }
    doSomething: function() {
      // public methods have no "_" prefix
    },
    _helper: function() {
      // private methods have an "_" prefix
    }
  });
})( jQuery );</code></pre></div></div></section>
<section><h2>Default Options</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">( function( $ ) {
  $.widget( "rich.stopwatch", {

    options: {
      autostart: true,
      direction: 'decreasing',
      increment: 100 // in milliseconds
    },
    ...
  });
})( jQuery );</code></pre></div></div></section>
<section><h2>Invoking Methods</h2><div class="content"><p>Public methods:</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">$('#timer').stopwatch('doSomething', 'optionalParam');

// or

var widget = $('#timer').data('richStopwatch');
widget.doSomething();</code></pre></div></div></section>
<section><h2>Invoking Methods</h2><div class="content"><p>Private methods <em>are</em> accessible:</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">var widget = $('#timer').data('richStopwatch');
widget._helper();</code></pre></div>
<p>Accessible private methods is helps with widget extension</p></div></section>
<section><h2>Lifecycle and callbacks</h2><div class="content"><div class="openblock side-by-side"><img src="images/cycle.png" alt="http://openclipart.org/detail/171954/cycle-color-by-karthikeyan-171954" />
<div class="list"><ul><li>_create / _destroy</li><li>disable / enable</li><li>_setOption</li><li>_trigger</li></ul></div></div></div></section>
<section class="center"><h2>Widget Initialisation</h2><div class="content"><p>Optionally override the <code>_create</code> method</p>
<div class="list"><ul><li>Apply DOM changes</li><li>Register event listeners</li><li><em>create</em> event fired implicitly</li></ul></div></div></section>
<section><h2>Create</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">_create: function() {
  this.digitsElement = this.element.find('.digits');
  this.startTime = this.digits();
  this.digits(this.startTime);
  if (this.options.autostart) {
    this._createInterval();
  }
  if (this.options.showProgressBar) {
    this._addProgressBar();
  }
},</code></pre></div></div></section>
<section><h2>Widget Clean Up</h2><div class="content"><div class="openblock side-by-side"><img src="images/tidy.png" alt="http://openclipart.org/detail/90451/keep-tidy-outside-01-by-anonymous" />
<div class="list"><ul><li>Leave the DOM as you found it</li><li>Remove any event handlers</li><li>Remove any timers/intervals</li></ul></div></div></div></section>
<section><h2>Destroy!</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">_destroy: function() {
  this._removeInterval();
  if (this.progressBar) {
    this.progressBar.parents('.progress').first().remove();
  }
  this.digitsElement.text(this.startTime);
  this._trigger('destroy', undefined, this._dumpUi());
}</code></pre></div></div></section>
<section><h2>Enable / Disable</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">$.widget = {
  ...
  enable: function() {
    return this._setOptions({ disabled: false });
  },

  disable: function() {
    return this._setOptions({ disabled: true });
  },

}</code></pre></div></div></section>
<section><h2>Mutable Options</h2><div class="content"><p>The widget Factory provides the <code>option</code> method for getting/setting the initialisation options</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">$('#timer').stopwatch('option', 'showProgressBar', false);</code></pre></div>
<p>Hook in via the <code>_setOption</code> method if required</p>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Alternatively you can get a reference to the widget object<div class="list"><ul><li>Some options have an implicit effect, eg. <code>increment</code></li><li>For other options some explicit action is required, eg. <code>showProgressBar</code></li></ul></div></li></ul></div></details></details></div></section>
<section><h2>Mutable Options</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">_setOption: function (key, value) {
  var widget = this;
  if (this.options.key === value) {
    return;
  }
  switch (key) {
    ...
  }
  this._super(key, value);
},</code></pre></div></div></section>
<section><h2>Mutable Options</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">case 'disabled':
  if (value === true) widget._disable();
  else widget._enable();
  break;
case 'showProgressBar':
  if (value === true &amp;&amp; !widget.progressBar) {
    widget._addProgressBar();
  } else if (value === false &amp;&amp; widget.progressBar) {
    widget._removeProgressBar();
  }
  break;</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Point out the disabled implementation here</li></ul></div></details></details></div></section>
<section><h2>Events &amp; Callbacks</h2><div class="content"><div class="openblock side-by-side"><div class="list"><ul><li>Events allow for object extension</li><li>Callbacks provided as either:<ol class="arabic"><li>plugin options</li><li>event listeners</li></ol></li></ul></div>
<img src="images/party.png" alt="http://openclipart.org/detail/181653/new-years-party-by-liftarn-181653" /></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>No list of callbacks to maintain and notify</li></ul></div></details></details></div></section>
<section><h2>Callbacks as options</h2><div class="content"><p class="center">Option name matches the event name:</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">var options = {
  ...

  create: function(event, ui) {
    ui.element.css('background-color', ready);
    ui.element.css('color', 'white');
  }</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Option name matches the event name</li><li>Discuss the ui parameter</li></ul></div></details></details></div></section>
<section><h2>Callbacks as event listeners</h2><div class="content"><p>jQuery event is prefixed with the event name</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">$('#timer').on('stopwatchcreate'), function(event, ui) {
  ui.element.css('background-color', ready);
  ui.element.css('color', 'white');
});</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>jQuery events are all lowercase</li><li>Event name prefix is overridable with widgetEventPrefix</li></ul></div></details></details></div></section>
<section><h2>Triggering events</h2><div class="content"><p>Triggering events couldn&#8217;t be any easier:</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">this._trigger('eventname', event, ui);</code></pre></div>
<div class="list"><div class="title">Function Parameters:</div><ul><li><code>event</code> usually propagates an observed event</li><li><code>ui</code> is an object that shares widget states</li></ul></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Consider checking the disabled state before triggering events</li></ul></div></details></details></div></section>
<section><h2>The UI parameter</h2><div class="content"><p>Consolidate <code>ui</code> object creation in a method</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">_dumpUi: function() {
  return {
    element: this.element,
    digits: this.digits()
  };
},</code></pre></div></div></section>
<section><h2>A note on styling</h2><div class="content"><p>Adopting the jQuery UI widget factory <em>does not</em> tie you to the jQuery UI themes.</p>
<p>Examples in this demo were styled with:</p>
<div class="center"><ul class="center"><li>Bootstrap</li><li>less.js</li></ul></div></div></section>
<section class="topic"><h2>Testing and Docs</h2><div class="content"></div></section>
<section><h2>Testing</h2><div class="content"><div class="list"><ul><li><a href="http://pivotal.github.io/jasmine/">Jasmine</a> - BDD for javascript</li><li><a href="https://github.com/velesin/jasmine-jquery">Jasmine-jQuery</a> - API for handling DOMfixtures in your tests</li><li><a href="http://karma-runner.github.io/">Karma</a> - test runner</li></ul></div>
<div class="sidebarblock"><div class="content"><p><a href="https://github.com/richwidgets/richwidgets/blob/master/TESTS.md">github.com/richwidgets/richwidgets/blob/master/TESTS.md</a></p></div></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Jasmine is a behavior-driven development framework for testing JavaScript code</li><li>Jasmine-jquery provides an API for handling HTML, CSS, and JSON fixtures in your specs</li><li>Karma is the test runner, it controls the browser and executes the tests</li></ul></div></details></details></div></section>
<section><h2>Jasmine Example</h2><div class="content"><div class="listingblock"><pre class="highlight"><code class="javascript">describe("The 'toBe' matcher compares with ===", function() {
  it("and has a positive case ", function() {
      expect(true).toBe(true);
    });
  it("and can have a negative case", function() {
      expect(false).not.toBe(true);
    });
});</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Jasmine provides an API that provides us with a vocabulary for writing tests</li></ul></div></details></details></div></section>
<section><h2>API docs</h2><div class="content"><p>YUIDoc can be used to provide generated API documentation</p>
<div class="listingblock"><pre class="highlight"><code class="javascript">options: {
  /**
   * Whether to start the stopwatch on plugin execution
   *
   * @property autostart
   * @type Boolean
   * @default true
   */
  autostart: true,</code></pre></div>
<details><details open=""><summary>Notes</summary><div class="list"><ul><li>Javadoc can be hard to give up</li></ul></div></details></details></div></section>
<section><h2>Stopwatch API docs</h2><div class="content"><div class="sidebarblock"><div class="content"><p><a href="/assets/api/classes/stopwatch.html" target="API">/assets/api/classes/stopwatch.html</a></p></div></div></div></section>
<section class="topic"><h2>Stopwatch example</h2><div class="content"></div></section>
<section><div class="openblock scroll"><div class="listingblock"><pre class="highlight"><code class="javascript">/**
 * A stopwatch widget
 *
 * @module Output
 * @class chart
 */
(function ($) {

  $.widget('rich.stopwatch', {

    options: {
      autostart: true,
      direction: 'decreasing',
      disabled: false,
      showProgressBar: true,
      increment: 100 // in milliseconds
    },

    _create: function() {
      this.digitsElement = this.element.find('.digits');
      this.startTime = this.digits();
      this.digits(this.startTime);
      if (this.options.autostart) {
        this._createInterval();
      }
      if (this.options.showProgressBar) {
        this._addProgressBar();
      }
    },

    start: function() {
      if (this.isRunning()) {
        return;
      }
      this.reset();
      this._createInterval();
    },

    resume: function() {
      this._createInterval();
    },

    pause: function() {
      this._removeInterval();
    },

    stop: function() {
      this.digits(0);
      this._removeInterval();
    },

    reset: function() {
      if (this.options.disabled) {
        return;
      }
      this._removeInterval();
      this.digits(this.startTime);
      this._trigger('reset', undefined, this._dumpUi());
    },

    isRunning: function() {
      return !!this.intervalId;
    },

    digits: function(value) {
      if (typeof value === 'undefined') {
        return parseFloat(this.digitsElement.text());
      } else if (! this.options.disabled) {
        if (value &lt;= 0) {
          value = 0;
        }
        this.digitsElement.text(value.toFixed(2));
        this._updateProgressBar();
      }
    },

    _createInterval: function() {
      if (!this.intervalId &amp;&amp; !this.options.disabled) {
        this.intervalId = setInterval($.proxy(this._decrementCount, this), this.options.increment);
        this._trigger('start', undefined, this._dumpUi());
      }
    },

    _removeInterval: function() {
      if (this.intervalId &amp;&amp; !this.options.disabled) {
        clearInterval(this.intervalId);
        this.intervalId = null;
        this._trigger('stop', undefined, this._dumpUi());
      }
    },

    _decrementCount: function() {
      var delta = this.options.increment/1000;
      var time = this.options.direction === 'increasing' ?
        this.digits() + delta : this.digits() - delta;
      this.digits(time);
      if (time &lt;= 0) {
        this._removeInterval();
      }
    },

    _addProgressBar: function() {
      if (this.options.direction === 'increasing') {
        return;
      }
      this.progressBar = $('&lt;div class="progress-bar" style="width: 0%;" /&gt;');
      var progress = $('&lt;div class="progress" /&gt;').append(this.progressBar);
      this._updateProgressBar();
      this.element.append(progress);
    },

    _removeProgressBar: function() {
      if (this.progressBar) {
        this.progressBar.parents('.progress').first().remove();
        this.progressBar = null;
      }
    },

    _updateProgressBar: function() {
      if (! this.progressBar) {
        return;
      }
      var value = 100 - (this.digits() / this.startTime * 100);
      this.progressBar.css('width', value.toFixed(4) + '%');
    },

    _disable: function () {
      this._removeInterval();
      this.element.addClass('disabled');
    },

    _enable: function () {
      this.element.removeClass('disabled');
    },

    _dumpUi: function() {
      return {
        element: this.element,
        digits: this.digits()
      };
    },

    _getCreateEventData: function() {
      // called when the widget factory fires its create event
      return this._dumpUi();
    },

    _setOption: function (key, value) {
      var widget = this;
      if (this.options.key === value) {
        return;
      }
      switch (key) {
        case 'disabled':
          if (value === true) {
            widget._disable();
          } else {
            widget._enable();
          }
          break;
        case 'showProgressBar':
          if (value === true &amp;&amp; !widget.progressBar) {
            widget._addProgressBar();
          } else if (value === false &amp;&amp; widget.progressBar) {
            widget._removeProgressBar();
          }
          break;
      }
      this._super(key, value);
    },

    _destroy: function() {
      this._removeInterval();
      this._removeProgressBar();
      this.digitsElement.text(this.startTime);
      this._trigger('destroy', undefined, this._dumpUi());
    }

  });
}(jQuery) );</code></pre></div></div></section>
<section><h2>Dev environment</h2><div class="content"></div></section>
<section><h2>Learn More</h2><div class="content"><div class="list"><ul><li><a href="https://api.jqueryui.com/jquery.widget/">https://api.jqueryui.com/jquery.widget/</a></li><li><a href="http://ajpiano.com/widgetfactory">http://ajpiano.com/widgetfactory</a></li><li><a href="https://learn.jquery.com/jquery-ui/widget-factory/how-to-use-the-widget-factory/">https://learn.jquery.com/jquery-ui/widget-factory/how-to-use-the-widget-factory/</a></li></ul></div></div></section>
<section class="topic ending"><h2>The End!</h2><div class="content"></div></section><script src="./dzslides/core/dzslides.js"></script><script src="./dzslides/highlight/highlight.pack.js"></script><script type="text/javascript">var nodes = document.querySelectorAll(".listingblock pre");
for (var i = 0; i < nodes.length; ++i) {
  hljs.highlightBlock(nodes[i]);
};</script></body></html>